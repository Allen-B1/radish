<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game | Radish</title>
    <script type="module" crossorigin>var ut=Object.defineProperty;var ct=(e,t,s)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var Se=(e,t,s)=>ct(e,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();function ke(){}function xe(e){return e()}function Je(){return Object.create(null)}function _e(e){e.forEach(xe)}function et(e){return typeof e=="function"}function dt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function pt(e){return Object.keys(e).length===0}const mt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function A(e,t){e.appendChild(t)}function W(e,t,s){e.insertBefore(t,s||null)}function J(e){e.parentNode&&e.parentNode.removeChild(e)}function ht(e,t){for(let s=0;s<e.length;s+=1)e[s]&&e[s].d(t)}function T(e){return document.createElement(e)}function te(e){return document.createTextNode(e)}function Y(){return te(" ")}function yt(){return te("")}function we(e,t,s,r){return e.addEventListener(t,s,r),()=>e.removeEventListener(t,s,r)}function B(e,t,s){s==null?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function _t(e){return Array.from(e.childNodes)}function oe(e,t){t=""+t,e.data!==t&&(e.data=t)}function be(e,t,s,r){s==null?e.style.removeProperty(t):e.style.setProperty(t,s,"")}function V(e,t,s){e.classList.toggle(t,!!s)}let Ve;function ge(e){Ve=e}const he=[],Ce=[];let ye=[];const Te=[],vt=Promise.resolve();let je=!1;function wt(){je||(je=!0,vt.then(tt))}function Me(e){ye.push(e)}const Ae=new Set;let pe=0;function tt(){if(pe!==0)return;const e=Ve;do{try{for(;pe<he.length;){const t=he[pe];pe++,ge(t),bt(t.$$)}}catch(t){throw he.length=0,pe=0,t}for(ge(null),he.length=0,pe=0;Ce.length;)Ce.pop()();for(let t=0;t<ye.length;t+=1){const s=ye[t];Ae.has(s)||(Ae.add(s),s())}ye.length=0}while(he.length);for(;Te.length;)Te.pop()();je=!1,Ae.clear(),ge(e)}function bt(e){if(e.fragment!==null){e.update(),_e(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Me)}}function gt(e){const t=[],s=[];ye.forEach(r=>e.indexOf(r)===-1?t.push(r):s.push(r)),s.forEach(r=>r()),ye=t}const kt=new Set;function Lt(e,t){e&&e.i&&(kt.delete(e),e.i(t))}function We(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Et(e,t,s){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,s),Me(()=>{const l=e.$$.on_mount.map(xe).filter(et);e.$$.on_destroy?e.$$.on_destroy.push(...l):_e(l),e.$$.on_mount=[]}),i.forEach(Me)}function St(e,t){const s=e.$$;s.fragment!==null&&(gt(s.after_update),_e(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function At(e,t){e.$$.dirty[0]===-1&&(he.push(e),wt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Nt(e,t,s,r,i,l,a=null,h=[-1]){const b=Ve;ge(e);const o=e.$$={fragment:null,ctx:[],props:l,update:ke,not_equal:i,bound:Je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(b?b.$$.context:[])),callbacks:Je(),dirty:h,skip_bound:!1,root:t.target||b.$$.root};a&&a(o.root);let N=!1;if(o.ctx=s?s(e,t.props||{},(j,p,...y)=>{const k=y.length?y[0]:p;return o.ctx&&i(o.ctx[j],o.ctx[j]=k)&&(!o.skip_bound&&o.bound[j]&&o.bound[j](k),N&&At(e,j)),p}):[],o.update(),N=!0,_e(o.before_update),o.fragment=r?r(o.ctx):!1,t.target){if(t.hydrate){const j=_t(t.target);o.fragment&&o.fragment.l(j),j.forEach(J)}else o.fragment&&o.fragment.c();t.intro&&Lt(e.$$.fragment),Et(e,t.target,t.anchor),tt()}ge(b)}class Bt{constructor(){Se(this,"$$");Se(this,"$$set")}$destroy(){St(this,1),this.$destroy=ke}$on(t,s){if(!et(s))return ke;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(s),()=>{const i=r.indexOf(s);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!pt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const qt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(qt);function ae(e){return e.type=="army"?e.data:e.data[0]}const He={fall:"Fall",fall_retreat:"Fall",spring:"Spring",spring_retreat:"Spring",winter:"Winter"};function Ot(e){let t=e.split("-"),s=Number(t[1]);switch(t[0]){case"spring":return`spring_retreat-${s}`;case"spring_retreat":return`fall-${s}`;case"fall":return`fall_retreat-${s}`;case"fall_retreat":return`winter-${s}`;case"winter":return`spring-${s+1}`}throw new Error("unknown phase: "+e)}function G(e){let t=e.split("-"),s=Number(t[1]);switch(t[0]){case"spring":return`winter-${s-1}`;case"spring_retreat":return`spring-${s}`;case"fall":return`spring_retreat-${s}`;case"fall_retreat":return`fall-${s}`;case"winter":return`fall_retreat-${s}`}throw new Error("unknown phase: "+e)}function Pe(e,t,s){let r=s(e);return ie(r)&&(!t[G(r)]||Object.keys(t[G(r)].retreats).length==0)?Pe(r,t,s):r}function Ct(e,t){return Pe(e,t,Ot)}function jt(e,t){return Pe(e,t,G)}function X(e){return e.split("-")[0]=="winter"}function ie(e){return e.split("-")[0].endsWith("retreat")}const{window:Ne}=mt;function Be(e){const t=e.slice(),s=t[14].c||t[12]=="convoy"?"convoy":t[14].s||t[12]=="support"?"support":"move";return t[38]=s,t}function qe(e){const t=e.slice(),s=Number(t[1].split("-")[1]);return t[39]=s,t}function Xe(e,t,s){const r=e.slice();r[40]=t[s];const i=r[1]&&r[5][r[1]]&&Object.values(r[5][r[1]].ownership).filter(function(...a){return e[30](r[40],...a)}).length||0;return r[41]=i,r}function Oe(e){const t=e.slice(),s=Object.values(t[7]).filter(function(...i){return e[29](t[40],...i)}).length;return t[44]=s,t}function Ye(e){let t,s;return{c(){t=T("span"),B(t,"style",s="background:"+e[0].powers[e[40][0]].sc_color),B(t,"class","power-color svelte-1m0kcqa")},m(r,i){W(r,t,i)},p(r,i){i[0]&513&&s!==(s="background:"+r[0].powers[r[40][0]].sc_color)&&B(t,"style",s)},d(r){r&&J(t)}}}function Fe(e){let t,s=e[40][1]+"",r;return{c(){t=T("div"),r=te(s),B(t,"class","power-user svelte-1m0kcqa")},m(i,l){W(i,t,l),A(t,r)},p(i,l){l[0]&512&&s!==(s=i[40][1]+"")&&oe(r,s)},d(i){i&&J(t)}}}function Re(e){let t,s=e[41]-e[44]>0?"+":"",r,i=e[41]-e[44]+"",l;return{c(){t=T("span"),r=te(s),l=te(i),B(t,"class","power-builds svelte-1m0kcqa")},m(a,h){W(a,t,h),A(t,r),A(t,l)},p(a,h){h[0]&674&&s!==(s=a[41]-a[44]>0?"+":"")&&oe(r,s),h[0]&674&&i!==(i=a[41]-a[44]+"")&&oe(l,i)},d(a){a&&J(t)}}}function ze(e){let t,s,r,i,l=(e[40][0]?e[0].powers[e[40][0]].name||e[40][0]:e[40][1])+"",a,h,b,o=e[1]&&X(e[1]),N,j,p=e[41]+"",y,k,n=e[40][0]&&Ye(e),u=e[40][0]&&Fe(e),m=o&&Re(Oe(e));return{c(){t=T("div"),n&&n.c(),s=Y(),r=T("div"),i=T("div"),a=te(l),h=Y(),u&&u.c(),b=Y(),m&&m.c(),N=Y(),j=T("span"),y=te(p),k=Y(),B(i,"class","power-country svelte-1m0kcqa"),B(r,"class","power-name svelte-1m0kcqa"),B(j,"class","power-sc svelte-1m0kcqa"),B(t,"class","player svelte-1m0kcqa"),V(t,"me",e[10]&&e[40][0]==e[10]),be(t,"background",e[10]&&e[40][0]==e[10]?e[0].powers[e[10]].tile_color:"")},m(w,S){W(w,t,S),n&&n.m(t,null),A(t,s),A(t,r),A(r,i),A(i,a),A(r,h),u&&u.m(r,null),A(t,b),m&&m.m(t,null),A(t,N),A(t,j),A(j,y),A(t,k)},p(w,S){w[40][0]?n?n.p(w,S):(n=Ye(w),n.c(),n.m(t,s)):n&&(n.d(1),n=null),S[0]&513&&l!==(l=(w[40][0]?w[0].powers[w[40][0]].name||w[40][0]:w[40][1])+"")&&oe(a,l),w[40][0]?u?u.p(w,S):(u=Fe(w),u.c(),u.m(r,null)):u&&(u.d(1),u=null),S[0]&2&&(o=w[1]&&X(w[1])),o?m?m.p(Oe(w),S):(m=Re(Oe(w)),m.c(),m.m(t,N)):m&&(m.d(1),m=null),S[0]&546&&p!==(p=w[41]+"")&&oe(y,p),S[0]&1536&&V(t,"me",w[10]&&w[40][0]==w[10]),S[0]&1537&&be(t,"background",w[10]&&w[40][0]==w[10]?w[0].powers[w[10]].tile_color:"")},d(w){w&&J(t),n&&n.d(),u&&u.d(),m&&m.d()}}}function Ue(e){let t,s,r,i,l,a=He[e[1].split("-")[0]]+"",h,b,o="'"+(e[39]<10?"0"+e[39]:e[39]),N,j,p=ie(e[1])?"retreats":"",y,k,n,u,m,w,S=e[1]==e[2]&&Ge(e);return{c(){t=T("div"),s=T("button"),s.textContent="<",r=Y(),i=T("div"),l=T("div"),h=te(a),b=Y(),N=te(o),j=Y(),y=te(p),k=Y(),S&&S.c(),n=Y(),u=T("button"),u.textContent=">",B(s,"class","svelte-1m0kcqa"),B(l,"id","phase"),B(l,"class","svelte-1m0kcqa"),be(i,"display","flex"),be(i,"flex-direction","column"),be(i,"justify-content","center"),B(i,"class","svelte-1m0kcqa"),B(u,"class","svelte-1m0kcqa"),B(t,"class","panel svelte-1m0kcqa"),B(t,"id","phase-panel")},m(P,q){W(P,t,q),A(t,s),A(t,r),A(t,i),A(i,l),A(l,h),A(l,b),A(l,N),A(l,j),A(l,y),A(i,k),S&&S.m(i,null),A(t,n),A(t,u),m||(w=[we(s,"click",e[31]),we(u,"click",e[32])],m=!0)},p(P,q){q[0]&2&&a!==(a=He[P[1].split("-")[0]]+"")&&oe(h,a),q[0]&2&&o!==(o="'"+(P[39]<10?"0"+P[39]:P[39]))&&oe(N,o),q[0]&2&&p!==(p=ie(P[1])?"retreats":"")&&oe(y,p),P[1]==P[2]?S?S.p(P,q):(S=Ge(P),S.c(),S.m(i,null)):S&&(S.d(1),S=null)},d(P){P&&J(t),S&&S.d(),m=!1,_e(w)}}}function Ge(e){let t,s=$e(e[11]-e[13])+"",r,i;return{c(){t=T("div"),r=te(s),i=te(" left"),B(t,"id","adj-time")},m(l,a){W(l,t,a),A(t,r),A(t,i)},p(l,a){a[0]&10240&&s!==(s=$e(l[11]-l[13])+"")&&oe(r,s)},d(l){l&&J(t)}}}function Ke(e){let t,s=!X(e[1]),r,i=X(e[1]),l=s&&Qe(Be(e)),a=i&&Ze(e);return{c(){t=T("div"),l&&l.c(),r=Y(),a&&a.c(),B(t,"class","panel svelte-1m0kcqa"),B(t,"id","status-panel")},m(h,b){W(h,t,b),l&&l.m(t,null),A(t,r),a&&a.m(t,null)},p(h,b){b[0]&2&&(s=!X(h[1])),s?l?l.p(Be(h),b):(l=Qe(Be(h)),l.c(),l.m(t,r)):l&&(l.d(1),l=null),b[0]&2&&(i=X(h[1])),i?a?a.p(h,b):(a=Ze(h),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(h){h&&J(t),l&&l.d(),a&&a.d()}}}function Qe(e){let t,s,r,i,l;return{c(){t=T("div"),t.textContent="Move",s=Y(),r=T("div"),r.textContent="Convoy",i=Y(),l=T("div"),l.textContent="Support",B(t,"class","svelte-1m0kcqa"),V(t,"active",e[38]=="move"),B(r,"class","svelte-1m0kcqa"),V(r,"active",e[38]=="convoy"),B(l,"class","svelte-1m0kcqa"),V(l,"active",e[38]=="support")},m(a,h){W(a,t,h),W(a,s,h),W(a,r,h),W(a,i,h),W(a,l,h)},p(a,h){h[0]&20480&&V(t,"active",a[38]=="move"),h[0]&20480&&V(r,"active",a[38]=="convoy"),h[0]&20480&&V(l,"active",a[38]=="support")},d(a){a&&(J(t),J(s),J(r),J(i),J(l))}}}function Ze(e){let t,s,r;return{c(){t=T("div"),t.textContent="Army",s=Y(),r=T("div"),r.textContent="Fleet",B(t,"class","svelte-1m0kcqa"),V(t,"active",e[14].a),B(r,"class","svelte-1m0kcqa"),V(r,"active",e[14].f)},m(i,l){W(i,t,l),W(i,s,l),W(i,r,l)},p(i,l){l[0]&16384&&V(t,"active",i[14].a),l[0]&16384&&V(r,"active",i[14].f)},d(i){i&&(J(t),J(s),J(r))}}}function Mt(e){let t,s,r,i,l,a,h,b,o,N,j=We(e[9]),p=[];for(let n=0;n<j.length;n+=1)p[n]=ze(Xe(e,j,n));let y=e[1]&&Ue(qe(e)),k=e[1]==e[2]&&e[2]&&Ke(e);return{c(){t=T("div"),s=Y(),r=T("div"),i=T("h3"),i.textContent="Players",l=Y();for(let n=0;n<p.length;n+=1)p[n].c();a=Y(),y&&y.c(),h=Y(),k&&k.c(),b=yt(),B(t,"id","map"),B(t,"class","svelte-1m0kcqa"),V(t,"no-touch",!e[2]||e[2]!=e[1]),V(t,"move-none",e[2]&&!X(e[2])&&e[3]==null),V(t,"move-army",e[2]&&!X(e[2])&&e[3]&&e[7][e[4]||e[3]]&&e[7][e[4]||e[3]].type=="army"),V(t,"move-fleet",e[2]&&!X(e[2])&&e[3]&&e[7][e[4]||e[3]]&&e[7][e[4]||e[3]].type=="fleet"),V(t,"build-army",e[2]&&X(e[2])&&e[1]==e[2]&&e[14].a),V(t,"build-fleet",e[2]&&X(e[2])&&e[1]==e[2]&&e[14].f),B(i,"class","svelte-1m0kcqa"),B(r,"class","panel svelte-1m0kcqa"),B(r,"id","players")},m(n,u){W(n,t,u),e[28](t),W(n,s,u),W(n,r,u),A(r,i),A(r,l);for(let m=0;m<p.length;m+=1)p[m]&&p[m].m(r,null);W(n,a,u),y&&y.m(n,u),W(n,h,u),k&&k.m(n,u),W(n,b,u),o||(N=[we(Ne,"load",e[15]),we(Ne,"keydown",e[16]),we(Ne,"keyup",e[17])],o=!0)},p(n,u){if(u[0]&6&&V(t,"no-touch",!n[2]||n[2]!=n[1]),u[0]&12&&V(t,"move-none",n[2]&&!X(n[2])&&n[3]==null),u[0]&156&&V(t,"move-army",n[2]&&!X(n[2])&&n[3]&&n[7][n[4]||n[3]]&&n[7][n[4]||n[3]].type=="army"),u[0]&156&&V(t,"move-fleet",n[2]&&!X(n[2])&&n[3]&&n[7][n[4]||n[3]]&&n[7][n[4]||n[3]].type=="fleet"),u[0]&16390&&V(t,"build-army",n[2]&&X(n[2])&&n[1]==n[2]&&n[14].a),u[0]&16390&&V(t,"build-fleet",n[2]&&X(n[2])&&n[1]==n[2]&&n[14].f),u[0]&1699){j=We(n[9]);let m;for(m=0;m<j.length;m+=1){const w=Xe(n,j,m);p[m]?p[m].p(w,u):(p[m]=ze(w),p[m].c(),p[m].m(r,null))}for(;m<p.length;m+=1)p[m].d(1);p.length=j.length}n[1]?y?y.p(qe(n),u):(y=Ue(qe(n)),y.c(),y.m(h.parentNode,h)):y&&(y.d(1),y=null),n[1]==n[2]&&n[2]?k?k.p(n,u):(k=Ke(n),k.c(),k.m(b.parentNode,b)):k&&(k.d(1),k=null)},i:ke,o:ke,d(n){n&&(J(t),J(s),J(r),J(a),J(h),J(b)),e[28](null),ht(p,n),y&&y.d(n),k&&k.d(n),o=!1,_e(N)}}}const me="http://www.w3.org/2000/svg";function $e(e){let t=Math.floor(e/1e3),s=Math.floor(t/60),r=t%60;return s?s+"m"+r+"s":r+"s"}function Vt(e,t,s){let r,i,l,a,h=[],b="",o=null,N=null,j=0,p=null,y=null,k="move",n={},u={};function m(g,O){return o==null?g:(O||(O=q[o]&&q[o].units[g]),O&&O.type=="fleet"&&O.data[1]!=""?g+"-"+O.data[1]:g)}function w(g,O){g=g/l.width,O=O/l.width;let L=16/l.width,c=document.createElementNS(me,"g");return c.innerHTML=`
            <line x1=${H(g-L)} x2=${H(g+L)} y1=${H(O-L)} y2=${H(O+L)} />
            <line x1=${H(g+L)} x2=${H(g-L)} y1=${H(O-L)} y2=${H(O+L)} />
        `,c.classList.add("disband"),E.appendChild(c),c}let S=u,P=n,q={},ce={},M={},Le={},D={},E;function H(g){return g*E.viewBox.baseVal.width+E.viewBox.baseVal.x}function se(g){return g*E.viewBox.baseVal.height+E.viewBox.baseVal.y}function Ee(g,O,L,c){var fe;let _=E.getBoundingClientRect(),f=document.getElementById(O+"-"+g),d=f.cloneNode(!0);d.style.display="",d.removeAttribute("id"),d.classList.add("unit");let v=f.getBoundingClientRect(),F=v.left+v.width/2+window.scrollX,re=v.top+v.height/2+window.scrollY,I=H(F/_.width),C=se(re/_.height),U=H(L/l.width),Q=se(c/l.height);return d.setAttribute("transform","translate("+(U-I)+","+(Q-C)+") "+d.getAttribute("transform")),(fe=f.parentNode)==null||fe.appendChild(d),d}let K=null;async function st(){let g=location.pathname.split("/")[2],O=JSON.parse(await(await fetch("/games/"+g+"/meta.json")).text()),L=await(await fetch("/variants/"+O.variant+"/map.svg")).text();s(8,r.innerHTML=L,r),s(18,i=JSON.parse(await(await fetch("/variants/"+O.variant+"/adj.json")).text())),s(19,l=JSON.parse(await(await fetch("/variants/"+O.variant+"/pos.json")).text())),s(0,a=JSON.parse(await(await fetch("/variants/"+O.variant+"/meta.json")).text())),s(26,E=r.querySelector("svg")),s(26,E.innerHTML+=`  <defs>
    <!-- A marker to be used as an arrowhead -->
    <marker
      id="arrow"
      viewBox="0 0 10 10"
      refX="5"
      refY="5"
      markerWidth="${16/l.width*E.viewBox.baseVal.width}"
      markerHeight="${16/l.width*E.viewBox.baseVal.width}"
      orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#000" />
    </marker>
    <marker
      id="arrow-fail"
      viewBox="0 0 10 10"
      refX="5"
      refY="5"
      markerWidth="${16/l.width*E.viewBox.baseVal.width}"
      markerHeight="${16/l.width*E.viewBox.baseVal.width}"
      orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" class="arrow-fail" />
    </marker>
    <marker
      id="arrow-retreat"
      viewBox="0 0 10 10"
      refX="5"
      refY="5"
      markerWidth="${16/l.width*E.viewBox.baseVal.width}"
      markerHeight="${16/l.width*E.viewBox.baseVal.width}"
      orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" class="arrow-retreat" />
    </marker>
  </defs>`,E);var c=document.createElement("style");c.textContent=`
        .build { stroke-dasharray: ${8*E.viewBox.baseVal.width/l.width} !important;
            stroke-width:  ${8*E.viewBox.baseVal.width/l.width} !important; }
        .order, .disband line { stroke-width: ${4*E.viewBox.baseVal.width/l.width} !important; }
        .support { stroke-dasharray: ${4*E.viewBox.baseVal.width/l.width} }
        .convoy { stroke-dasharray: ${16*E.viewBox.baseVal.width/l.width} ${4*E.viewBox.baseVal.width/l.width} }
        `,document.getElementsByTagName("head")[0].appendChild(c);for(let f in i.provinces)for(let d of[""].concat(i.provinces[f].coasts)){let v=f+(d?"-"+d:""),F=E.querySelector("#"+v);if(F)F.classList.add("tile");else{let re=H(l.provinces[v].x/l.width),I=se(l.provinces[v].y/l.height),C=document.createElementNS(me,"circle");C.id=f,C.setAttribute("cx",re+""),C.setAttribute("cy",I+""),C.setAttribute("r",String(24*E.viewBox.baseVal.height/l.height)),C.classList.add("tile","added"),d!=""&&C.classList.add("coast"),C.id=v,E.appendChild(C),F=C}i.provinces[f].is_sea&&F.classList.add("sea"),d&&F.classList.add("coast"),d==""&&i.provinces[f].coasts.length!=0&&F.classList.add("has-coast"),i.fleet_adj.find(re=>re[0][0]==f)==null&&F.classList.add("landlocked"),F.addEventListener("click",re=>{if(!(N==null||N!=o)){if(ie(N)&&M[G(N)]){console.log("retreat");let I=M[G(N)].retreats;s(12,k="move"),p==null?I[f]&&ae(I[f].src)==b&&s(3,p=f):p==f?(s(20,n[p]={type:"hold"},n),s(3,p=s(4,y=null))):I[p]&&I[p].dest.filter(([C,U])=>C==f&&U==d).length!=0?(s(20,n[p]={type:"move",dest:[f,d]},n),s(3,p=null)):I[p]&&console.log(I[p].dest.filter(([C,U])=>C==f&&U==d),I[p].dest)}else if(!X(N))p==null?D&&D[f]&&ae(D[f])==b&&s(3,p=f):y==null&&(le.s||le.c)?(s(4,y=f),s(12,k=le.s?"support":"convoy")):(k=="move"?p!=f?s(20,n[p]={type:"move",dest:[f,d]},n):s(20,n[p]={type:"hold"},n):(k=="convoy"||k=="support")&&y&&y!=f?(s(20,n[p]={type:k=="convoy"?"convoy":"support_move",src:y,dest:f},n),D&&D[y]&&ae(D[y])==b&&s(20,n[y]={type:"move",dest:[f,d]},n)):k=="support"&&y&&y==f&&(s(20,n[p]={type:"support_hold",target:f},n),(!n[f]||n[f].type=="move")&&s(20,n[f]={type:"hold"},n)),s(3,p=s(4,y=null)),s(12,k="move"));else if(X(N)&&q[N]&&D){let I=Object.values(D).filter(Q=>ae(Q)==b).length,C=Object.values(q[N].ownership).filter(Q=>Q==b).length,U=Math.abs(I-C);if(C<I&&D[f])if(u[f])delete u[f],s(21,u);else{if(Object.keys(u).length>=U)return;s(21,u[f]={type:"disband"},u)}else if(C>I&&!D[f]&&q[N].ownership[f]==b)if(u[f])delete u[f],s(21,u);else{if(Object.keys(u).length>=U)return;if(a.provinces[f].home_sc!=b||q[N].ownership[f]!=b){console.log(f,a.provinces[f].home_sc);return}le.f?s(21,u[f]={type:"fleet",coast:d},u):le.a&&s(21,u[f]={type:"army"},u)}}}})}let _=Array.from(document.querySelectorAll("[id^=fleet-]")).concat(Array.from(document.querySelectorAll("[id^=army-]")));for(let f of _)f.classList.add("unit");s(7,D),s(1,o),s(5,q),s(0,a),s(27,K=new WebSocket("/games/"+g+"/ws")),s(27,K.onopen=()=>{let f=new Map(document.cookie.split(";").map(d=>d.trim().split("="))).get("token");K.send(JSON.stringify({type:"auth",token:f}))},K),s(27,K.onmessage=f=>{let d=JSON.parse(f.data);switch(d.type){case"game_info":s(10,b=d.power);break;case"update_players":s(9,h=d.players);break;case"map_state":{let v=`${d.phase}-${d.year}`;s(5,q[v]=d.state,q);break}case"phase":{let v=`${d.phase}-${d.year}`;s(5,q[v]=d.state,q),o||s(1,o=v),s(20,n=s(21,u={})),s(2,N=v),s(11,j=d.adj_time);break}case"error":{console.error(d.msg);break}case"movement_adj":{let v=`${d.phase}-${d.year}`;s(24,ce[v]=d.orders,ce),s(6,M[v]=M[v]||{retreat_orders:{}},M),s(6,M[v].order_status=d.order_status,M),s(6,M[v].retreats=d.retreats,M);break}case"build_adj":{let v=`${d.phase}-${d.year}`;s(25,Le[v]=d.builds,Le);break}case"retreat_adj":{let v=`${d.phase}-${d.year}`;s(24,ce[v]=d.orders,ce);break}}},K)}let Ie=Date.now();setInterval(()=>{s(13,Ie=Date.now())},1e3);let le={};function lt(g){s(14,le[g.key]=!0,le)}function rt(g){s(14,le[g.key]=!1,le)}function nt(g){Ce[g?"unshift":"push"](()=>{r=g,s(8,r)})}const it=(g,O)=>ae(O)==g[0],ot=(g,O)=>O==g[0],at=()=>{o&&s(1,o=jt(o,M))},ft=()=>{o&&s(1,o=Ct(o,M))};return e.$$.update=()=>{var g,O;if(e.$$.dirty[0]&2&&s(3,p=s(4,y=null)),e.$$.dirty[0]&8){let L=document.querySelectorAll(".prov-active");for(let c of L)c.classList.remove("prov-active");p&&((g=document.getElementById(p))==null||g.classList.add("prov-active"))}if(e.$$.dirty[0]&16){let L=document.querySelectorAll(".prov-active-2");for(let c of L)c.classList.remove("prov-active-2");y&&((O=document.getElementById(y))==null||O.classList.add("prov-active-2"))}if(e.$$.dirty[0]&35651590&&s(22,S=o==N?u:o&&Le[o]||{}),e.$$.dirty[0]&4718626){document.querySelectorAll(".build").forEach(c=>c.remove()),document.querySelectorAll(".disband-build").forEach(c=>c.remove());let L=o&&q[o]&&q[o].ownership;if(L)for(let c in S){let _=S[c],f=c+("coast"in _&&_.coast?"-"+_.coast:""),d=l.provinces[f];switch(_.type){case"disband":{w(d.x,d.y).classList.add("disband-build");break}case"army":{let v=Ee("army",L[c],d.x,d.y);v.classList.remove("unit"),v.classList.add("build");break}case"fleet":{let v=Ee("fleet",L[c],d.x,d.y);v.classList.remove("unit"),v.classList.add("build");break}}}}if(e.$$.dirty[0]&17825798&&s(23,P=o==N?n:o&&ce[o]||{}),e.$$.dirty[0]&76021858){document.querySelectorAll(".order").forEach(c=>c.remove());let L=o&&M[o]&&M[o].order_status||null;for(let c in P){let _=P[c];switch(_.type){case"move":{let ne=m(c);o&&ie(o)&&M[G(o)]&&c in M[G(o)].retreats&&(ne=m(c,M[G(o)].retreats[c].src));let ue=_.dest[0]+(_.dest[1]?"-"+_.dest[1]:""),Z=l.provinces[ne].x,R=l.provinces[ne].y,$=l.provinces[ue].x,x=l.provinces[ue].y;o&&q[o].units[c]&&ie(o)&&(Z+=16,R+=8);let ee=Math.sqrt((Z-$)**2+(R-x)**2),de=Math.max(ee*.5,ee-16);$=Z+de/ee*($-Z),x=R+de/ee*(x-R);let z=document.createElementNS(me,"line");z.classList.add("order","move"),z.setAttribute("x1",H(Z/l.width)+""),z.setAttribute("y1",se(R/l.height)+""),z.setAttribute("x2",H($/l.width)+""),z.setAttribute("y2",se(x/l.height)+""),L&&L[c]!=!0?z.classList.add("fail"):o&&ie(o)&&z.classList.add("retreat"),E.appendChild(z);break}case"support_hold":{let ne=m(c),ue=m(_.target),Z=l.provinces[ne].x,R=l.provinces[ne].y,$=l.provinces[ue].x,x=l.provinces[ue].y,ee=Math.sqrt((Z-$)**2+(R-x)**2),de=Math.max(ee*.5,ee-16);$=Z+de/ee*($-Z),x=R+de/ee*(x-R);let z=document.createElementNS(me,"line");z.classList.add("order","support"),z.setAttribute("x1",H(Z/l.width)+""),z.setAttribute("y1",se(R/l.height)+""),z.setAttribute("x2",H($/l.width)+""),z.setAttribute("y2",se(x/l.height)+""),L&&L[c]!=!0&&z.classList.add("fail"),E.appendChild(z);break}case"hold":{if(o&&ie(o)&&M[G(o)]&&c in M[G(o)].retreats){let $=m(c,M[G(o)].retreats[c].src),[x,ee]=[l.provinces[$].x,l.provinces[$].y];q[o].units[c]&&(x+=16,ee+=8),w(x,ee).classList.add("order");break}let ne=m(c),ue=l.provinces[ne].x,Z=l.provinces[ne].y,R=document.createElementNS(me,"circle");R.setAttribute("cx",""+H(ue/l.width)),R.setAttribute("cy",""+se(Z/l.height)),R.setAttribute("r",""+28/l.width*E.viewBox.baseVal.height),R.classList.add("order","hold"),L&&L[c]!=!0&&R.classList.add("retreat"),E.appendChild(R);break}case"support_move":case"convoy":let f=m(c),d=m(_.src),v=_.dest;P[_.src]&&P[_.src].type=="move"&&P[_.src].dest[1]&&(v+="-"+P[_.src].dest[1]),console.log(v,P);let F=l.provinces[f].x,re=l.provinces[f].y,I=l.provinces[d].x,C=l.provinces[d].y,U=l.provinces[v].x,Q=l.provinces[v].y,fe=Math.sqrt((I-U)**2+(C-Q)**2),De=Math.max(fe*.5,fe-16);U=I+De/fe*(U-I),Q=C+De/fe*(Q-C),F=H(F/l.width),I=H(I/l.width),U=H(U/l.width),re=se(re/l.height),C=se(C/l.height),Q=se(Q/l.height);let ve=document.createElementNS(me,"path");ve.classList.add("order"),ve.classList.add(_.type=="convoy"?"convoy":"support"),ve.setAttribute("d",`M ${F} ${re} C ${I} ${C}, ${I} ${C}, ${U} ${Q}`),L&&L[c]!=!0&&ve.classList.add("fail"),E.appendChild(ve);break}}}if(e.$$.dirty[0]&35&&(o&&q[o]?s(7,D=q[o].units):a?s(7,D=a.starting_state.units):s(7,D={})),e.$$.dirty[0]&262179&&o&&q[o]&&a){let L=q[o].ownership,c=q[o].units;for(let _ in i.provinces){if(i.provinces[_].is_sea)continue;let f=document.getElementById(_);if(!f)continue;let d=document.getElementById("sc-"+_),v=L[_];if(!a.provinces[_].is_sc&&c[_]&&(v=ae(c[_])),v){let F=a.powers[v];f.style.fill=F.tile_color,d&&(d.style.fill=F.sc_color)}else f.style.fill=a.data.land_color,d&&(d.style.fill=a.data.land_color)}}if(e.$$.dirty[0]&67633346){let L=Array.from(document.getElementsByClassName("unit"));for(let c of L)c.remove();if(E){for(let c in D){let _;D[c].type=="army"?_=l.provinces[c]:_=l.provinces[c+(D[c].data[1]?"-"+D[c].data[1]:"")],Ee(D[c].type,ae(D[c]),_.x,_.y)}if(o&&ie(o)&&M[G(o)]){console.log("drawing retreats",M[G(o)].retreats);for(let c in M[G(o)].retreats){let _=M[G(o)].retreats[c].src,f;_.type=="army"?f=l.provinces[c]:f=l.provinces[c+(_.data[1]?"-"+_.data[1]:"")],D[c]&&(f=Object.assign({},f),f.x+=16,f.y+=8),Ee(_.type,ae(_),f.x,f.y).classList.add("retreat")}}}}e.$$.dirty[0]&135266304&&K!=null&&K.readyState==WebSocket.OPEN&&K.send(JSON.stringify({type:"orders",orders:n})),e.$$.dirty[0]&136314880&&K!=null&&K.readyState==WebSocket.OPEN&&K.send(JSON.stringify({type:"builds",builds:u}))},[a,o,N,p,y,q,M,D,r,h,b,j,k,Ie,le,st,lt,rt,i,l,n,u,S,P,ce,Le,E,K,nt,it,ot,at,ft]}class Pt extends Bt{constructor(t){super(),Nt(this,t,Vt,Mt,dt,{},null,[-1,-1])}}new Pt({target:document.getElementById("app")});
</script>
    <style rel="stylesheet" crossorigin>body{font-family:Arial,sans-serif;font-size:16px;padding:0;margin:0;background:#171a1c;color:#fff}a{color:#3986ac}a:visited{color:#8c53c6}.block{padding:16px;border-radius:0;background:#22282a}.block>:first-child{margin-top:0}.block>:last-child{margin-bottom:0}h3{margin:0 0 8px;font-size:20px}header{background:#ac3973;color:#fff;display:flex;align-items:center;flex-direction:row;padding:8px 16px}header h2{margin:4px 0;flex-grow:1;font-size:22px}header a,header a:visited,header a:active{color:#fff;text-decoration:none}header>*:not(:last-child){margin-right:16px}main{padding:16px;max-width:1024px;margin:16px auto auto}h1{margin-top:0;font-size:28px;text-align:center}.button,button,::file-selector-button{border:0;background:#ac3973;color:#fff!important;text-decoration:none!important;cursor:pointer;display:inline-block;padding:4px 8px;border-radius:0;font-size:15px}input[type=color]{background:transparent;border:0;cursor:pointer;padding:0}input[type=color]:active{filter:brightness(75%)}::-moz-color-swatch,::-webkit-color-swatch{border:0}.input{color:#fff;padding:4px 8px;border:2px solid hsla(0,0%,50%,.5);background:transparent}.input::placeholder{color:#ffffff80}.input:focus{border-color:#ac3973;outline:none}.button:active,button:active,::file-selector-button:active{background:#8a2859}.button.accent,button.accent{background:#62a63f}.button.accent:active,button.accent:active{background:#4c8131}.panel-2{display:flex;flex-direction:row;align-items:flex-start}@media (max-width: 720px){.panel-2{flex-direction:column;align-items:stretch}}.g_id_signin div{border-radius:0!important}.folder{display:block}.folder-title{display:block;color:#fff!important;background:#22282a;padding:8px 16px;text-decoration:none}.folder-content{background:#191d1f;padding:16px;display:none}.folder-content>:first-child{margin-top:0}.folder:target>.folder-content{display:block}.folder:target>.folder-title{background:#ac3973}.tile{cursor:pointer}.tile.added{z-index:10;fill:#00000013}.tile.added.prov-active{fill:#0003}.tile.added.prov-active-2{fill:#f003}.tile.prov-active{filter:brightness(80%)}.tile.prov-active-2{filter:brightness(80%) hue-rotate(90deg)}.build-army.svelte-1m0kcqa .coast,.build-army.svelte-1m0kcqa .sea,.build-fleet.svelte-1m0kcqa .landlocked,.build-fleet.svelte-1m0kcqa .has-coast,.move-army.svelte-1m0kcqa .coast,.move-army.svelte-1m0kcqa .sea,.move-fleet.svelte-1m0kcqa .landlocked,.move-fleet.svelte-1m0kcqa .has-coast,.no-touch.svelte-1m0kcqa .tile,.move-none.svelte-1m0kcqa .coast{pointer-events:none}.build-army.svelte-1m0kcqa .coast.added,.build-army.svelte-1m0kcqa .sea.added,.build-fleet.svelte-1m0kcqa .landlocked.added,.build-fleet.svelte-1m0kcqa .has-coast.added,.move-army.svelte-1m0kcqa .coast.added,.move-army.svelte-1m0kcqa .sea.added,.move-fleet.svelte-1m0kcqa .landlocked.added,.move-fleet.svelte-1m0kcqa .has-coast.added,.no-touch.svelte-1m0kcqa .tile.added,.move-none.svelte-1m0kcqa .coast{display:none}.panel.svelte-1m0kcqa.svelte-1m0kcqa{position:fixed;top:16px;left:16px;background:#161b1d;padding:16px}.panel.svelte-1m0kcqa h3.svelte-1m0kcqa{margin-top:0;text-align:center;font-size:18px}#players.svelte-1m0kcqa.svelte-1m0kcqa{padding:0 0 16px;width:320px}#players.svelte-1m0kcqa h3.svelte-1m0kcqa{padding:16px 16px 8px;margin:0}.player.svelte-1m0kcqa.svelte-1m0kcqa{display:flex;align-items:center;flex-direction:row}.player.me.svelte-1m0kcqa.svelte-1m0kcqa{color:#000}.power-color.svelte-1m0kcqa.svelte-1m0kcqa{width:16px;align-self:stretch;display:inline-block}.power-name.svelte-1m0kcqa.svelte-1m0kcqa{display:flex;flex-direction:column;align-items:stretch;justify-content:center;padding:4px 16px;flex-grow:1}.power-country.svelte-1m0kcqa.svelte-1m0kcqa{font-size:16px}.power-user.svelte-1m0kcqa.svelte-1m0kcqa{font-size:13px;margin-top:0}.player.svelte-1m0kcqa>span.svelte-1m0kcqa:not(.power-color){padding:8px 16px;margin:0;text-align:center;font-size:16px}#phase-panel.svelte-1m0kcqa.svelte-1m0kcqa{left:50%;transform:translate(-50%);display:flex;flex-direction:row;min-width:256px;padding:0}#phase-panel.svelte-1m0kcqa button.svelte-1m0kcqa{padding:8px 16px;font-size:32px;background:transparent}#phase-panel.svelte-1m0kcqa button.svelte-1m0kcqa:active{background:#00000080}#phase-panel.svelte-1m0kcqa>div.svelte-1m0kcqa{text-align:center;flex-grow:1;margin:0 4px}#phase.svelte-1m0kcqa.svelte-1m0kcqa{font-size:20px}body{background:#fff}.order{fill:transparent;pointer-events:none;z-index:11}.hold.order{--arrow-color:#000;stroke:#000}.move.order{stroke:#000;marker-end:url(#arrow)}.convoy.order{stroke:#2d2d86}.support{z-index:12;stroke:#000}.order.fail{marker-end:url(#arrow-fail);stroke:#d22d2d}.arrow-fail{fill:#d22d2d}.unit.retreat{filter:drop-shadow(1px 0 1px hsl(35,100%,50%)) drop-shadow(-1px 0 1px hsl(35,100%,50%)) drop-shadow(0 1px 1px hsl(35,100%,50%)) drop-shadow(0 -1px 1px hsl(35,100%,50%))}.order.retreat{stroke:#df8f20;marker-end:url(#arrow-retreat)}.arrow-retreat{fill:#df8f20}text,[id^=sc-],.unit{pointer-events:none}.disband line{stroke:#d22d2d}.build,.disband{pointer-events:none}.build{stroke-linejoin:round}#status-panel.svelte-1m0kcqa.svelte-1m0kcqa{padding:0;position:fixed;bottom:16px;left:16px;top:auto;display:flex;flex-direction:row;width:256px}#status-panel.svelte-1m0kcqa>div.svelte-1m0kcqa{flex-grow:1;padding:8px 16px;text-align:center}#status-panel.svelte-1m0kcqa>div.active.svelte-1m0kcqa{background:#ac3973}
</style>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
